(this.webpackJsonpsrt2=this.webpackJsonpsrt2||[]).push([[0],{46:function(e,t,a){},47:function(e,t,a){},53:function(e,t,a){"use strict";a.r(t);var n=a(2),c=a(0),l=a.n(c),i=a(21),o=a.n(i),r=(a(46),a(7)),s=a(8),u=(a(47),a(28)),d=function(e){var t=e.text,a=e.x,c=e.y,l=e.width,i=e.size,o=e.style,s=e.id,u=e.globalStyle,d=e.editStyles;return Object(n.jsx)("p",{id:"".concat(s),style:Object(r.a)(Object(r.a)(Object(r.a)({position:"absolute",top:"".concat(c,"%"),left:"".concat(a,"%"),width:"".concat(l,"%"),fontSize:"".concat(i,"px")},o),u),d),children:t})},b=function(e){var t,a=e.imgPath,l=e.subtitle,i=e.page,o=e.editStyles,b=Object(u.a)(e,["imgPath","subtitle","page","editStyles"]),j=Object(c.useRef)(null),O=Object(c.useState)(0),v=Object(s.a)(O,2),f=v[0],g=v[1],h=Object(c.useState)(0),p=Object(s.a)(h,2),m=p[0],x=p[1],y=Object(c.useState)(0),S=Object(s.a)(y,2),_=S[0],k=S[1],C=Object(c.useState)(0),I=Object(s.a)(C,2),w=I[0],N=I[1],F=function(){var e,t,a,n;g(null===(e=j.current)||void 0===e?void 0:e.offsetTop),x(null===(t=j.current)||void 0===t?void 0:t.offsetLeft),k(null===(a=j.current)||void 0===a?void 0:a.offsetHeight),N(null===(n=j.current)||void 0===n?void 0:n.offsetWidth)};return Object(c.useEffect)((function(){return window.addEventListener("resize",F),function(){window.removeEventListener("resize",F)}}),[]),console.log(l),Object(n.jsxs)("div",{children:[Object(n.jsx)("div",{style:{position:"absolute",zIndex:11,top:f,left:m,width:w,height:_},children:null===(t=l[i])||void 0===t?void 0:t.sort((function(e,t){return e.index-t.index})).map((function(e){var t,a=e.text,c=e.x,r=e.y,s=e.width,u=e.size,b=e.style,j=e.index;return Object(n.jsx)(d,{id:j,text:a,globalStyle:l.__global_style__,editStyles:null===o||void 0===o||null===(t=o[i])||void 0===t?void 0:t[j],x:c,y:r,width:s,size:u*w/100,style:b},j)}))}),Object(n.jsx)("img",Object(r.a)({onLoad:F,ref:j,src:(null===l||void 0===l?void 0:l.__image_link__[i])||a,alt:i},b))]})},j=function(e){var t={},a="",n=0,c=0;return e.split("\n").map((function(e){if(e.includes("$START"))a=e.substring(6).trim().split("|")[0],t[a]=[],e.substring(6).trim().split("|")[1]&&(t.__global_style__=JSON.parse(e.substring(6).trim().split("|")[1])),e.substring(6).trim().split("|")[2]&&(Object.keys(t).includes("__image_link__")||(t.__image_link__={}),t.__image_link__[a]=e.substring(6).trim().split("|")[2]);else if(e.includes("$END"))a="";else if(e.includes(">>")){var l,i,o=e.substring(2),r=o.split("|")[0].split("-"),u=Object(s.a)(r,4),d=u[0],b=u[1],j=u[2],O=u[3];null===(l=t[a])||void 0===l||l.push({index:o.split("|")[2]?parseInt(o.split("|")[2]):c+n,x:parseFloat(d),y:parseFloat(b),size:parseFloat(j),width:parseFloat(O),style:JSON.parse(null===(i=o.split("|"))||void 0===i?void 0:i[1])}),c=o.split("|")[2]?parseInt(o.split("|")[2]):c,n+=1}else if(e.length>1){var v,f;if((null===(v=t[a])||void 0===v?void 0:v.length)>0)t[a][(null===(f=t[a])||void 0===f?void 0:f.length)-1].text=e}})),t},O=a(33),v=a(12),f=a(61),g=a(58),h=a(36),p=a(59),m=a(40),x=a(35),y=a(60),S=a(34),_="#0f04",k=function(e){var t=e.placeholder,a=e.value,c=e.onChange,l=e.className,i=void 0===l?"":l,o=Object(u.a)(e,["placeholder","value","onChange","className"]);return Object(n.jsx)(y.a,{className:"mb-3 "+i,children:Object(n.jsx)(S.a,Object(r.a)({placeholder:t,"aria-label":t,"aria-describedby":"basic-addon1",onChange:function(e){return c(e.target.value)},value:a},o))})};function C(e,t,a){var n=new Blob([e],{type:a});if(window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(n,t);else{var c=document.createElement("a"),l=URL.createObjectURL(n);c.href=l,c.download=t,document.body.appendChild(c),c.click(),setTimeout((function(){document.body.removeChild(c),window.URL.revokeObjectURL(l)}),0)}}var I=function(e){return function(t){var a=t.target.files;if(FileReader&&a&&a.length){var n=new FileReader;n.onload=function(){return e(n)},n.readAsDataURL(a[0])}}},w=function(e){return function(t){var a=t.target.files;if(FileReader&&a&&a.length){var n=new FileReader;n.onload=function(){return e(n)},n.readAsText(a[0])}}},N=function(e){var t,a,l,i=e.sub,o=e.setSub,u=e.page,d=e.setPage,b=e.setImage,y=e.image,S=(e.setImageStyle,e.setEditStyles),N=Object(c.useState)(u||"page1"),F=Object(s.a)(N,2),L=F[0],T=F[1],z=Object(c.useState)(!1),P=Object(s.a)(z,2),R=P[0],E=P[1],G=Object(c.useState)(1),A=Object(s.a)(G,2),D=A[0],J=A[1],B=Object(c.useState)(0),U=Object(s.a)(B,2),X=U[0],Y=U[1],$=Object(c.useState)(0),W=Object(s.a)($,2),H=W[0],M=W[1],q=Object(c.useState)(0),K=Object(s.a)(q,2),V=K[0],Q=K[1],Z=Object(c.useState)(0),ee=Object(s.a)(Z,2),te=ee[0],ae=ee[1],ne=Object(c.useState)(""),ce=Object(s.a)(ne,2),le=ce[0],ie=ce[1],oe=Object(c.useState)(!0),re=Object(s.a)(oe,2),se=re[0],ue=re[1],de=Object(c.useState)({}),be=Object(s.a)(de,2),je=be[0],Oe=be[1],ve=Object(c.useState)(""),fe=Object(s.a)(ve,2),ge=fe[0],he=fe[1],pe=Object(c.useState)(""),me=Object(s.a)(pe,2),xe=me[0],ye=me[1],Se=Object(c.useState)("sub"),_e=Object(s.a)(Se,2),ke=_e[0],Ce=_e[1],Ie=Object(c.useState)((null===(t=i["".concat(L)])||void 0===t?void 0:t.reduce((function(e,t){return t.index>e?t.index:e}),0))+1),we=Object(s.a)(Ie,2),Ne=we[0],Fe=we[1];Object(c.useEffect)((function(){!function(){if(S(Object(v.a)({},L,Object(v.a)({},D,{backgroundColor:_}))),Object.keys(i).includes(L))try{o((function(e){var t;return Object(r.a)(Object(r.a)({},e),{},Object(v.a)({},L,Object(O.a)(null===(t=e[L])||void 0===t?void 0:t.map((function(e){return e.index===parseInt(String(D))?Object(r.a)(Object(r.a)({},e),{},{x:parseFloat(X),y:parseFloat(H),width:parseFloat(V),size:parseFloat(te),text:le,style:Object(r.a)({},je)}):e})))))}))}catch(e){console.log(e)}}()}),[X,H,V,te,le,je,u]);var Le=function(e){if(L){var t,a=null===(t=(e||i)[L])||void 0===t?void 0:t.find((function(e){return e.index===parseInt(String(D))}));Y((function(e){return(null===a||void 0===a?void 0:a.x)||e})),M((function(e){return(null===a||void 0===a?void 0:a.y)||e})),Q((function(e){return(null===a||void 0===a?void 0:a.width)||e})),ae((function(e){return(null===a||void 0===a?void 0:a.size)||e})),ie((null===a||void 0===a?void 0:a.text)||""),Oe((function(e){return(null===a||void 0===a?void 0:a.style)?Object(r.a)({},null===a||void 0===a?void 0:a.style):Object(r.a)({},e)}))}};return Object(c.useEffect)((function(){Le()}),[D,L]),Object(c.useEffect)((function(){var e;E(!Object.keys(i).includes(L)),Object.keys(i).includes(L)&&d(L),Fe((null===(e=i[L])||void 0===e?void 0:e.reduce((function(e,t){var a=t.index;return a>e?a:e}),0))+1)}),[L]),Object(n.jsxs)(f.a,{style:{position:"fixed",width:"500px",left:0,overflowY:"auto",overflowX:"hidden",zIndex:50},children:[Object(n.jsxs)("div",{className:"form-check form-switch mr-0",children:[Object(n.jsx)("input",{className:"form-check-input",type:"checkbox",onClick:function(){return ue((function(e){return!e}))},id:"flexSwitchCheckChecked",checked:se}),Object(n.jsx)("label",{className:"form-check-label",htmlFor:"flexSwitchCheckChecked",children:"Settings"})]}),se&&Object(n.jsxs)("div",{children:[Object(n.jsxs)(g.a,{className:"mb-2",children:[Object(n.jsxs)(f.a.Group,{className:" col-4 mb-0",controlId:"subtitle-file",children:[Object(n.jsx)(f.a.Label,{className:"btn btn-primary",children:"Load Image"}),Object(n.jsx)(f.a.Control,{readOnly:!0,onChange:I((function(e){localStorage.setItem("lastImage",String(e.result)),b(String(e.result))})),type:"file",style:{visibility:"hidden",height:"0px"},placeholder:"Image"})]}),Object(n.jsxs)(f.a.Group,{className:" col-4 mb-0",controlId:"image-file",children:[Object(n.jsx)(f.a.Label,{className:"btn btn-primary",children:"Load SubTitle"}),Object(n.jsx)(f.a.Control,{readOnly:!0,onChange:w((function(e){var t;localStorage.setItem("lastPSRT",String(e.result));var a=j(String(e.result));o(a),Fe((null===(t=a[L])||void 0===t?void 0:t.reduce((function(e,t){var a=t.index;return a>e?a:e}),0))+1),Le(a)})),type:"file",style:{visibility:"hidden",height:"0px"},placeholder:"Image"})]}),Object(n.jsx)(h.a,{className:" col-2",onClick:function(){o({page1:[]}),T("page1"),J(0),Fe(0)},variant:"danger",children:"Clear All"}),Object(n.jsx)(k,{className:"mt-2 col-12",value:(null===y||void 0===y?void 0:y.includes("base64"))?"File":y,placeholder:"Image Link",onChange:function(e){b((function(t){return"File"===e?t:(a=L,n=e,o((function(e){return Object(r.a)(Object(r.a)({},e),{},{__image_link__:Object(r.a)(Object(r.a)({},null===e||void 0===e?void 0:e.__image_link__),{},Object(v.a)({},a,n))})})),e);var a,n}))}})]}),Object(n.jsxs)(g.a,{style:{alignItems:"flex-end"},children:[Object(n.jsxs)(f.a.Group,{className:" col-3 mb-0",controlId:"formPage",children:[Object(n.jsx)(f.a.Label,{children:"Page"}),Object(n.jsx)(f.a.Control,{value:L,onChange:function(e){return T(e.target.value)},placeholder:"Page"})]}),Object(n.jsx)(h.a,{className:" col-2",onClick:function(){R&&(o(Object(r.a)(Object(r.a)({},i),{},Object(v.a)({},L,[{index:parseInt(String(0)),x:parseFloat(String(X)),y:parseFloat(String(H)),width:parseFloat(String(V)),size:parseFloat(String(te)),text:le,style:Object(r.a)(Object(r.a)({},je),{},{backgroundColor:_})}]))),Le(i),J(0),Fe(1),d(L),Le())},disabled:!R,variant:"primary",children:"Add page"}),Object(n.jsxs)(f.a.Group,{className:" col-3 mb-0",controlId:"formIndex",children:[Object(n.jsx)(f.a.Label,{children:"Index"}),Object(n.jsx)(f.a.Control,{value:D,onChange:function(e){return J(e.target.value)},type:"number",min:"0",max:null===(a=i[String(L)])||void 0===a?void 0:a.length,step:"1",placeholder:"index"})]}),Object(n.jsx)(h.a,{className:" col-2",onClick:function(){o((function(e){return Object(r.a)(Object(r.a)({},e),{},Object(v.a)({},L,[].concat(Object(O.a)(e[L]),[{index:parseInt(String(Ne)),x:parseFloat(String(X)),y:parseFloat(String(H)),width:parseFloat(String(V)),size:parseFloat(String(te)),text:le,style:Object(r.a)(Object(r.a)({},je),{},{backgroundColor:_})}])))})),J(Ne),Fe((function(e){return e+1}))},variant:"primary",children:"Add Text"})]}),Object(n.jsxs)(g.a,{children:[Object(n.jsxs)(f.a.Group,{className:" col-3",controlId:"formX",children:[Object(n.jsx)(f.a.Label,{children:"X axis"}),Object(n.jsx)(f.a.Control,{value:X,onChange:function(e){return Y(e.target.value)},type:"number",min:"0",max:"100",step:"0.1",placeholder:"X"})]}),Object(n.jsxs)(f.a.Group,{className:" col-3",controlId:"formY",children:[Object(n.jsx)(f.a.Label,{children:"Y axis"}),Object(n.jsx)(f.a.Control,{value:H,onChange:function(e){return M(e.target.value)},type:"number",min:"0",max:"100",step:"0.1",placeholder:"Y"})]}),Object(n.jsxs)(f.a.Group,{className:" col-3",controlId:"formY",children:[Object(n.jsx)(f.a.Label,{children:"Size"}),Object(n.jsx)(f.a.Control,{value:te,onChange:function(e){return ae(e.target.value)},type:"number",min:"0",max:"100",step:"0.1",placeholder:"size"})]}),Object(n.jsxs)(f.a.Group,{className:" col-3",controlId:"formWidth",children:[Object(n.jsx)(f.a.Label,{children:"Width"}),Object(n.jsx)(f.a.Control,{value:V,onChange:function(e){return Q(e.target.value)},type:"number",min:"0",max:"100",step:"0.1",placeholder:"width"})]})]}),Object(n.jsxs)(g.a,{children:[Object(n.jsxs)(f.a.Group,{className:" col-8",controlId:"formText",children:[Object(n.jsx)(f.a.Label,{children:"Text"}),Object(n.jsx)(f.a.Control,{value:le,onChange:function(e){return ie(e.target.value)},type:"text",placeholder:"width"})]}),Object.keys(je).length>0&&Object(n.jsx)(p.a,{className:"col-4",variant:"secondary",id:"dropdown-basic-button",title:"Styles",children:Object.keys(je).length>0&&(null===(l=Object.keys(je))||void 0===l?void 0:l.map((function(e){return Object(n.jsx)(m.a.Item,{onClick:function(){return function(e){ye(je[e]),he(e);var t=Object(r.a)({},je);delete t[e],Oe(t)}(e)},children:"".concat(e.replaceAll("_"," ")," : ").concat(je[e])},e)})))})]}),Object(n.jsxs)(g.a,{children:[Object(n.jsx)(f.a.Group,{className:" col-4",controlId:"formKeyStyle",children:Object(n.jsx)(f.a.Control,{value:ge,onChange:function(e){return he(e.target.value)},type:"text",placeholder:"key"})}),Object(n.jsx)(f.a.Group,{className:" col-4",controlId:"formValueStyle",children:Object(n.jsx)(f.a.Control,{value:xe,onChange:function(e){return ye(e.target.value)},type:"text",placeholder:"value"})}),Object(n.jsx)(h.a,{style:{height:"100%"},className:"p-2 col-4 btn-secondary",onClick:function(){Oe((function(e){return Object(r.a)(Object(r.a)({},e),{},Object(v.a)({},ge,xe))})),ye(""),he("")},children:"Add Style"})]}),Object(n.jsxs)(g.a,{children:[Object(n.jsxs)(f.a.Group,{className:" col-6",controlId:"formDownload",children:[Object(n.jsx)(f.a.Label,{children:"Download Subtitle"}),Object(n.jsx)(f.a.Control,{value:ke,onChange:function(e){return Ce(e.target.value)},placeholder:"Download Subtitle"})]}),Object(n.jsxs)(x.a,{className:" col-6",children:[Object(n.jsx)(h.a,{className:" col-12 mb-2",disabled:!ke,onClick:function(){return C(function(e){var t="";return Object.keys(e).filter((function(e){return!e.includes("__")})).map((function(a){var n;t+="$START ".concat(a,"|").concat(JSON.stringify((null===e||void 0===e?void 0:e.__global_style__)||{}),"|").concat(null===e||void 0===e?void 0:e.__image_link__[a],"\n"),null===(n=e[a])||void 0===n||n.map((function(e,a){var n=e.x,c=e.y,l=e.size,i=e.width,o=e.text,r=e.style,s=e.index;t+=">>".concat(n,"-").concat(c,"-").concat(l,"-").concat(i,"|").concat(JSON.stringify(r),"|").concat(s||a,"\n"),t+="".concat(o,"\n\n")})),t+="$END ".concat(a,"\n\n")})),t}(i),"".concat(ke,".psrt"),"*.psrt")},variant:"primary",children:"(.psrt)"}),Object(n.jsx)(h.a,{className:" col-12",disabled:!ke,onClick:function(){return C(JSON.stringify(i),"".concat(ke,".json"),"*.json")},variant:"primary",children:"(.json)"})]})]})]})]})};a(52);var F=function(){var e=Object(c.useState)(localStorage.getItem("lastImage")||"assets/-fasc-nio-asi-tico-tsuki-ga-michibiku-isekai-douchuu-vol06-cap39-pag02.jpg"),t=Object(s.a)(e,2),a=t[0],l=t[1],i=Object(c.useState)({}),o=Object(s.a)(i,2),u=o[0],d=o[1],O=Object(c.useState)(localStorage.getItem("lastPSRT")?j(localStorage.getItem("lastPSRT")||""):function(e){var t={},a=new XMLHttpRequest;return a.open("GET",e,!1),a.onreadystatechange=function(){4===a.readyState&&(200!==a.status&&0!=a.status||(t=Object(r.a)({},j(a.responseText))))},a.send(null),t}("assets/-fasc-nio-asi-tico-tsuki-ga-michibiku-isekai-douchuu-vol06-cap39-pag02_.psrt")),v=Object(s.a)(O,2),f=v[0],g=v[1],h=Object(c.useState)(localStorage.getItem("lastPage")||"page1"),p=Object(s.a)(h,2),m=p[0],x=p[1],y=Object(c.useState)({}),S=Object(s.a)(y,2),_=S[0],k=S[1];return Object(c.useEffect)((function(){var e,t;(localStorage.setItem("lastPage",m),null===f||void 0===f||null===(e=f.__image_link__)||void 0===e?void 0:e[m])&&l(null===f||void 0===f||null===(t=f.__image_link__)||void 0===t?void 0:t[m])}),[m]),Object(c.useEffect)((function(){localStorage.setItem("lastImage",a)}),[a]),Object(n.jsxs)("div",{className:"App container",style:{display:"flex"},children:[Object(n.jsx)(N,{sub:f,setSub:g,page:m,setPage:x,setImage:l,image:a,setImageStyle:d,setEditStyles:k}),Object(n.jsxs)("div",{children:[Object(n.jsx)(b,{editStyles:_,imgPath:a,page:m,subtitle:f}),Object(n.jsx)(b,{style:Object(r.a)({width:"1300px"},u),editStyles:_,imgPath:a,page:m,subtitle:f})]})]})},L=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,62)).then((function(t){var a=t.getCLS,n=t.getFID,c=t.getFCP,l=t.getLCP,i=t.getTTFB;a(e),n(e),c(e),l(e),i(e)}))};o.a.render(Object(n.jsx)(l.a.StrictMode,{children:Object(n.jsx)(F,{})}),document.getElementById("root")),L()}},[[53,1,2]]]);
//# sourceMappingURL=main.de7b16cb.chunk.js.map