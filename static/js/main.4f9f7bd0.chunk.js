(this.webpackJsonpsrt2=this.webpackJsonpsrt2||[]).push([[0],{50:function(e,t,n){},51:function(e,t,n){},58:function(e,t,n){"use strict";n.r(t);var a=n(1),c=n(0),l=n.n(c),i=n(23),s=n.n(i),o=(n(50),n(7)),r=n(8),u=(n(51),n(31)),d=function(e){var t=e.text,n=e.x,c=e.y,l=e.width,i=e.size,s=e.style,r=e.id,u=e.globalStyle,d=e.editStyles;return Object(a.jsx)("p",{id:"".concat(r),style:Object(o.a)(Object(o.a)(Object(o.a)({position:"absolute",top:"".concat(c,"%"),left:"".concat(n,"%"),width:"".concat(l,"%"),fontSize:"".concat(i,"px")},s),u),d),children:t})},j=function(e){var t,n,l=e.imgPath,i=e.subtitle,s=e.page,j=e.editStyles,b=e.onClick,O=Object(u.a)(e,["imgPath","subtitle","page","editStyles","onClick"]),m=Object(c.useRef)(null),f=Object(c.useState)(0),g=Object(r.a)(f,2),x=g[0],h=g[1],v=Object(c.useState)(0),p=Object(r.a)(v,2),y=p[0],S=p[1],C=Object(c.useState)(0),_=Object(r.a)(C,2),N=_[0],k=_[1],I=Object(c.useState)(0),w=Object(r.a)(I,2),L=w[0],F=w[1],P=function(){var e,t,n,a;h(null===(e=m.current)||void 0===e?void 0:e.offsetTop),S(null===(t=m.current)||void 0===t?void 0:t.offsetLeft),k(null===(n=m.current)||void 0===n?void 0:n.offsetHeight),F(null===(a=m.current)||void 0===a?void 0:a.offsetWidth)};return Object(c.useEffect)((function(){return window.addEventListener("resize",P),function(){window.removeEventListener("resize",P)}}),[]),Object(a.jsxs)("div",{children:[Object(a.jsx)("div",{onMouseDown:function(e){b&&b(e),console.log(e)},style:{position:"absolute",zIndex:11,top:x,left:y,width:L,height:N},children:null===(t=i[s])||void 0===t?void 0:t.sort((function(e,t){return e.index-t.index})).map((function(e){var t,n=e.text,c=e.x,l=e.y,o=e.width,r=e.size,u=e.style,b=e.index;return Object(a.jsx)(d,{id:b,text:n,globalStyle:i.__global_style__,editStyles:null===j||void 0===j||null===(t=j[s])||void 0===t?void 0:t[b],x:c,y:l,width:o,size:r*L/100,style:u},b)}))}),Object(a.jsx)("img",Object(o.a)({onLoad:P,ref:m,src:l||(null===i||void 0===i||null===(n=i.__image_link__)||void 0===n?void 0:n[s]),alt:s},O))]})},b=function(e){var t={},n="",a=0,c=0;return e.split("\n").map((function(e){if(e.includes("$START"))n=e.substring(6).trim().split("|")[0],t[n]=[],e.substring(6).trim().split("|")[1]&&(t.__global_style__=JSON.parse(e.substring(6).trim().split("|")[1])),e.substring(6).trim().split("|")[2]&&(Object.keys(t).includes("__image_link__")||(t.__image_link__={}),t.__image_link__[n]=e.substring(6).trim().split("|")[2]);else if(e.includes("$END"))n="";else if(e.includes(">>")){var l,i,s=e.substring(2),o=s.split("|")[0].split("-"),u=Object(r.a)(o,4),d=u[0],j=u[1],b=u[2],O=u[3];null===(l=t[n])||void 0===l||l.push({index:s.split("|")[2]?parseInt(s.split("|")[2]):c+a,x:parseFloat(d),y:parseFloat(j),size:parseFloat(b),width:parseFloat(O),style:JSON.parse(null===(i=s.split("|"))||void 0===i?void 0:i[1])}),c=s.split("|")[2]?parseInt(s.split("|")[2]):c,a+=1}else if(e.length>1){var m,f;if((null===(m=t[n])||void 0===m?void 0:m.length)>0)t[n][(null===(f=t[n])||void 0===f?void 0:f.length)-1].text=e}})),t},O=n(36),m=n(13),f=n(21),g=n(66),x=n(63),h=n(39),v=n(38),p=n(64),y=n(44),S=n(65),C=n(37),_="#0f0",N=function(e){var t=e.placeholder,n=e.value,c=e.onChange,l=e.className,i=void 0===l?"":l,s=Object(u.a)(e,["placeholder","value","onChange","className"]);return Object(a.jsx)(S.a,{className:"mb-3 "+i,children:Object(a.jsx)(C.a,Object(o.a)({placeholder:t,"aria-label":t,"aria-describedby":"basic-addon1",onChange:function(e){return c(e.target.value)},value:n},s))})};function k(e,t,n){var a=new Blob([e],{type:n});if(window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(a,t);else{var c=document.createElement("a"),l=URL.createObjectURL(a);c.href=l,c.download=t,document.body.appendChild(c),c.click(),setTimeout((function(){document.body.removeChild(c),window.URL.revokeObjectURL(l)}),0)}}var I=function(e){return function(t){var n=t.target.files;if(FileReader&&n&&n.length){var a=new FileReader;a.onload=function(){return e(a)},a.readAsDataURL(n[0])}}},w=function(e){return function(t){var n=t.target.files;if(FileReader&&n&&n.length){var a=new FileReader;a.onload=function(){return e(a)},a.readAsText(n[0])}}},L=function(e){var t=e.options,n=e.title,c=e.onChange;return Object(a.jsxs)(g.a.Control,{onChange:c,as:"select",className:"mr-sm-2",id:"inlineFormCustomSelect",custom:!0,children:[Object(a.jsx)("option",{value:"none",children:n||"Choose..."}),t.map((function(e){return Object(a.jsx)("option",{value:e.id,children:e.name})}))]})},F=function(e){var t,n,l,i=e.sub,s=e.setSub,u=e.page,d=e.setPage,j=e.setImage,S=e.image,C=(e.setImageStyle,e.setEditStyles),F=(e.mouseImageClick,e.setMouseImageClick,e.mouse,Object(c.useState)(u||"page1")),P=Object(r.a)(F,2),T=P[0],z=P[1],E=Object(c.useState)(!1),R=Object(r.a)(E,2),G=R[0],J=R[1],A=Object(c.useState)(1),D=Object(r.a)(A,2),M=D[0],Y=D[1],X=Object(c.useState)(0),B=Object(r.a)(X,2),U=B[0],W=B[1],$=Object(c.useState)(0),H=Object(r.a)($,2),q=H[0],K=H[1],V=Object(c.useState)(0),Q=Object(r.a)(V,2),Z=Q[0],ee=Q[1],te=Object(c.useState)(0),ne=Object(r.a)(te,2),ae=ne[0],ce=ne[1],le=Object(c.useState)(""),ie=Object(r.a)(le,2),se=ie[0],oe=ie[1],re=Object(c.useState)(!0),ue=Object(r.a)(re,2),de=ue[0],je=ue[1],be=Object(c.useState)({}),Oe=Object(r.a)(be,2),me=Oe[0],fe=Oe[1],ge=Object(c.useState)(""),xe=Object(r.a)(ge,2),he=xe[0],ve=xe[1],pe=Object(c.useState)(""),ye=Object(r.a)(pe,2),Se=ye[0],Ce=ye[1],_e=Object(c.useState)("sub"),Ne=Object(r.a)(_e,2),ke=Ne[0],Ie=Ne[1],we=Object(c.useState)(100),Le=Object(r.a)(we,2),Fe=Le[0],Pe=Le[1],Te=Object(c.useState)(!1),ze=Object(r.a)(Te,2),Ee=ze[0],Re=ze[1],Ge=Object(c.useState)(!1),Je=Object(r.a)(Ge,2),Ae=Je[0],De=Je[1],Me=Object(c.useState)((null===(t=i["".concat(T)])||void 0===t?void 0:t.reduce((function(e,t){return t.index>e?t.index:e}),0))+1),Ye=Object(r.a)(Me,2),Xe=(Ye[0],Ye[1]);Object(c.useEffect)((function(){!function(){if(C(Object(m.a)({},T,Object(m.a)({},M,{border:"3px solid #0f0"}))),Object.keys(i).includes(T))try{s((function(e){var t;return Object(o.a)(Object(o.a)({},e),{},Object(m.a)({},T,Object(O.a)(null===(t=e[T])||void 0===t?void 0:t.map((function(e){return e.index===parseInt(String(M))?Object(o.a)(Object(o.a)({},e),{},{x:parseFloat(U),y:parseFloat(q),width:parseFloat(Z),size:parseFloat(ae),text:se,style:Object(o.a)({},me)}):e})))))}))}catch(e){console.log(e)}}()}),[U,q,Z,ae,se,me,u]);var Be=function(e){if(T){var t,n=null===(t=(e||i)[T])||void 0===t?void 0:t.find((function(e){return e.index===parseInt(String(M))}));W((function(e){return(null===n||void 0===n?void 0:n.x)||e})),K((function(e){return(null===n||void 0===n?void 0:n.y)||e})),ee((function(e){return(null===n||void 0===n?void 0:n.width)||e})),ce((function(e){return(null===n||void 0===n?void 0:n.size)||e})),oe((null===n||void 0===n?void 0:n.text)||""),fe((function(e){return(null===n||void 0===n?void 0:n.style)?Object(o.a)({},null===n||void 0===n?void 0:n.style):Object(o.a)({},e)}))}},Ue=function(){G&&(s(Object(o.a)(Object(o.a)({},i),{},Object(m.a)({},T,[{index:parseInt(String(0)),x:parseFloat(String(U)),y:parseFloat(String(q)),width:parseFloat(String(Z)),size:parseFloat(String(ae)),text:se,style:Object(o.a)(Object(o.a)({},me),{},{backgroundColor:_})}]))),Be(i),Y(0),Xe(1),d(T),Be(),Re(!1))};return Object(c.useEffect)((function(){Be()}),[M,T]),Object(c.useEffect)((function(){var e;J(!Object.keys(i).includes(T)),Object.keys(i).includes(T)&&d(T),Xe((null===(e=i[T])||void 0===e?void 0:e.reduce((function(e,t){var n=t.index;return n>e?n:e}),0))+1)}),[T]),Object(c.useEffect)((function(){var e=JSON.parse(localStorage.getItem("configs")||"{}");(null===e||void 0===e?void 0:e.maxTextSize)&&Pe(e.maxTextSize)}),[]),Object(a.jsxs)(g.a,{style:{position:"fixed",width:"500px",left:0,overflowY:"auto",overflowX:"hidden",zIndex:50},children:[Object(a.jsxs)("div",{className:"form-check form-switch mr-0",children:[Object(a.jsx)("input",{className:"form-check-input",type:"checkbox",onClick:function(){return je((function(e){return!e}))},id:"flexSwitchCheckChecked",checked:de}),Object(a.jsx)("label",{className:"form-check-label",htmlFor:"flexSwitchCheckChecked",children:"Settings"})]}),de&&Object(a.jsxs)("div",{className:"col-12",children:[Object(a.jsxs)(x.a,{className:"mb-2",children:[Object(a.jsxs)(g.a.Group,{className:" col-4 mb-0",controlId:"subtitle-file",children:[Object(a.jsx)(g.a.Label,{className:"btn btn-primary",children:"Load Image"}),Object(a.jsx)(g.a.Control,{readOnly:!0,onChange:I((function(e){localStorage.setItem("lastImage",String(e.result)),j(String(e.result))})),type:"file",style:{visibility:"hidden",height:"0px"},placeholder:"Image"})]}),Object(a.jsxs)(g.a.Group,{className:" col-4 mb-0",controlId:"image-file",children:[Object(a.jsx)(g.a.Label,{className:"btn btn-primary",children:"Load SubTitle"}),Object(a.jsx)(g.a.Control,{readOnly:!0,onChange:w((function(e){var t;localStorage.setItem("lastPSRT",String(e.result));var n=b(String(e.result));s(n),Xe((null===(t=n[T])||void 0===t?void 0:t.reduce((function(e,t){var n=t.index;return n>e?n:e}),0))+1),Be(n)})),type:"file",style:{visibility:"hidden",height:"0px"},placeholder:"Image"})]}),Object(a.jsx)(h.a,{className:" col-2",onClick:function(){s({page1:[]}),z("page1"),Y(0),Xe(0)},variant:"danger",children:"Clear All"}),Object(a.jsx)(N,{className:"mt-2 col-12",value:(null===S||void 0===S?void 0:S.includes("base64"))?"File":S,placeholder:"Image Link",onChange:function(e){j((function(t){return"File"===e?t:(n=T,a=e,s((function(e){return Object(o.a)(Object(o.a)({},e),{},{__image_link__:Object(o.a)(Object(o.a)({},null===e||void 0===e?void 0:e.__image_link__),{},Object(m.a)({},n,a))})})),e);var n,a}))}})]}),Object(a.jsxs)(x.a,{className:"col-12",style:{alignItems:"flex-end"},children:[Object(a.jsxs)(g.a.Group,{className:" col-3 mb-0",controlId:"formPage",children:[Object(a.jsx)(g.a.Label,{children:"Page"}),Ee?Object(a.jsx)(g.a.Control,{value:T,onChange:function(e){return z(e.target.value)},placeholder:"Page"}):Object(a.jsx)(L,{options:Object.keys(i).filter((function(e){return"__"!==e.slice(0,2)})).map((function(e){return{id:e,name:e.replaceAll("_"," ")}})),title:"Pages",onChange:function(e){return z(e.target.value)}})]}),Object(a.jsxs)(v.a,{className:"col-3",children:[Ee&&Object(a.jsx)(h.a,{className:"col-12 mb-1",onClick:function(){return Re(!1)},variant:"danger",children:"cancel"}),Object(a.jsx)(h.a,{className:"col-12",onClick:function(e){return Ee?Ue():Re(!0)},variant:"success",children:Ee?"confirm":Object(a.jsx)("b",{className:"fs-1 m-0 p-0",children:"+"})})]}),Object(a.jsxs)(g.a.Group,{className:" col-3 mb-0",controlId:"formPage",children:[Object(a.jsx)(g.a.Label,{children:"Index"}),Ae?Object(a.jsx)(g.a.Control,{value:T,onChange:function(e){return Y(e.target.value)},placeholder:"Index"}):Object(a.jsx)(L,{options:(null===(n=i[String(T)])||void 0===n?void 0:n.map((function(e,t){return{id:t,name:t}})))||[],title:"Indexes",onChange:function(e){return Y(e.target.value)}})]}),Object(a.jsxs)(v.a,{className:"col-3",children:[Ae&&Object(a.jsx)(h.a,{className:"col-12 mb-1 mr-0",onClick:function(){return De(!1)},variant:"danger",children:"cancel"}),Object(a.jsx)(h.a,{className:"col-12",onClick:function(e){return Ae?Ue():De(!0)},variant:"success",children:Ae?"confirm":Object(a.jsx)("b",{className:"fs-1 m-0 p-0",children:"+"})})]})]}),Object(a.jsxs)(x.a,{className:" col-12 p-0 mt-5 mb-5 ml-2 mr-2",children:[Object(a.jsxs)(v.a,{className:" col-2 p-0 m-0",children:[Object(a.jsxs)(g.a.Group,{className:" col-12 p-0 m-0",controlId:"formX",children:[Object(a.jsx)(g.a.Label,{children:"X axis"}),Object(a.jsx)(g.a.Control,{value:U,onChange:function(e){return W(e.target.value)},type:"number",min:"0",max:"100",step:"0.1",placeholder:"X"})]}),Object(a.jsxs)(g.a.Group,{className:" col-12 p-0 m-0",controlId:"formY",children:[Object(a.jsx)(g.a.Label,{children:"Y axis"}),Object(a.jsx)(g.a.Control,{value:q,onChange:function(e){return K(e.target.value)},type:"number",min:"0",max:"100",step:"0.1",placeholder:"Y"})]})]}),Object(a.jsx)(v.a,{className:" col-8 p-0 m-0",children:Object(a.jsxs)(x.a,{className:" col-12 justify-content-center m-0",children:[Object(a.jsx)(v.a,{className:" col-1 justify-content-center m-0 pt-3",children:Object(a.jsx)(f.a,{axis:"y",y:q||0,xstep:.1,onChange:function(e){var t=e.y;return K(t.toPrecision(2))}})}),Object(a.jsxs)(v.a,{className:" col-8 p-0 mr-1 ml-2",children:[Object(a.jsx)(f.a,{className:" mb-2",axis:"x",xstep:.1,x:U||0,onChange:function(e){var t=e.x;return W(t.toPrecision(2))}}),Object(a.jsx)("textarea",{value:se,onChange:function(e){return oe(e.target.value)},className:" col-12",style:{height:"80%"}}),Object(a.jsx)(f.a,{axis:"x",xstep:.1,x:Z||0,onChange:function(e){var t=e.x;return ee(t.toPrecision(2))}})]}),Object(a.jsx)(v.a,{className:" col-1 m-0 pt-3",children:Object(a.jsx)(f.a,{axis:"y",ystep:.1,ymax:Fe,y:ae||0,onChange:function(e){var t=e.y;return ce(t.toPrecision(2))}})})]})}),Object(a.jsxs)(v.a,{className:" col-2 p-0 m-0",children:[Object(a.jsxs)(g.a.Group,{className:"col-12 p-0 m-0",controlId:"formY",children:[Object(a.jsx)(g.a.Label,{children:"Size"}),Object(a.jsx)(g.a.Control,{value:ae,onChange:function(e){return ce(e.target.value)},type:"number",min:"0",max:"100",step:"0.1",placeholder:"size"})]}),Object(a.jsxs)(g.a.Group,{className:" col-12 p-0 m-0",controlId:"formWidth",children:[Object(a.jsx)(g.a.Label,{children:"Width"}),Object(a.jsx)(g.a.Control,{value:Z,onChange:function(e){return ee(e.target.value)},type:"number",min:"0",max:"100",step:"0.1",placeholder:"width"})]})]})]}),Object(a.jsxs)(x.a,{children:[Object(a.jsx)(g.a.Label,{className:"col-3 mb-4 ml-4",children:"Max Text Size"}),Object(a.jsx)(g.a.Control,{className:"col-2 mb-4 ",value:Fe,onChange:function(e){Pe(e.target.value);var t=JSON.parse(localStorage.getItem("configs")||"{}");localStorage.setItem("configs",JSON.stringify(Object(o.a)(Object(o.a)({},t),{},{maxTextSize:Fe})))},type:"number",min:"0",max:"100",step:"0.1",placeholder:"Max Text Size"}),Object.keys(me).length>0&&Object(a.jsx)(p.a,{className:"col-4 mb-4",variant:"secondary",id:"dropdown-basic-button",title:"Styles",children:Object.keys(me).length>0&&(null===(l=Object.keys(me))||void 0===l?void 0:l.map((function(e){return Object(a.jsx)(y.a.Item,{onClick:function(){return function(e){Ce(me[e]),ve(e);var t=Object(o.a)({},me);delete t[e],fe(t)}(e)},children:"".concat(e.replaceAll("_"," ")," : ").concat(me[e])},e)})))})]}),Object(a.jsxs)(x.a,{children:[Object(a.jsx)(g.a.Group,{className:" col-4",controlId:"formKeyStyle",children:Object(a.jsx)(g.a.Control,{value:he,onChange:function(e){return ve(e.target.value)},type:"text",placeholder:"key"})}),Object(a.jsx)(g.a.Group,{className:" col-4",controlId:"formValueStyle",children:Object(a.jsx)(g.a.Control,{value:Se,onChange:function(e){return Ce(e.target.value)},type:"text",placeholder:"value"})}),Object(a.jsx)(h.a,{style:{height:"100%"},className:"p-2 col-4 btn-secondary",onClick:function(){fe((function(e){return Object(o.a)(Object(o.a)({},e),{},Object(m.a)({},he,Se))})),Ce(""),ve("")},children:"Add Style"})]}),Object(a.jsxs)(x.a,{children:[Object(a.jsxs)(g.a.Group,{className:" col-6",controlId:"formDownload",children:[Object(a.jsx)(g.a.Label,{children:"Download Subtitle"}),Object(a.jsx)(g.a.Control,{value:ke,onChange:function(e){return Ie(e.target.value)},placeholder:"Download Subtitle"})]}),Object(a.jsxs)(v.a,{className:" col-6",children:[Object(a.jsx)(h.a,{className:" col-12 mb-2",disabled:!ke,onClick:function(){return k(function(e){var t="";return Object.keys(e).filter((function(e){return!e.includes("__")})).map((function(n){var a;t+="$START ".concat(n,"  |  ").concat(JSON.stringify((null===e||void 0===e?void 0:e.__global_style__)||{}),"  |  ").concat(null===e||void 0===e?void 0:e.__image_link__[n],"\n"),null===(a=e[n])||void 0===a||a.map((function(e,n){var a=e.x,c=e.y,l=e.size,i=e.width,s=e.text,o=e.style,r=e.index;t+=">>".concat(a,"-").concat(c,"-").concat(l,"-").concat(i,"  |  ").concat(JSON.stringify(o),"  |  ").concat(r||n,"\n"),t+="".concat(s,"\n\n")})),t+="$END ".concat(n,"\n\n")})),t}(i),"".concat(ke,".psrt"),"*.psrt")},variant:"primary",children:"(.psrt)"}),Object(a.jsx)(h.a,{className:" col-12",disabled:!ke,onClick:function(){return k(JSON.stringify(i),"".concat(ke,".json"),"*.json")},variant:"primary",children:"(.json)"})]})]})]})]})};n(57);var P=function(){var e=Object(c.useState)(localStorage.getItem("lastImage")||""),t=Object(r.a)(e,2),n=t[0],l=t[1],i=Object(c.useState)({}),s=Object(r.a)(i,2),u=s[0],d=s[1],O=Object(c.useState)(!1),m=Object(r.a)(O,2),f=m[0],g=m[1],x=Object(c.useState)(0),h=Object(r.a)(x,2),v=h[0],p=h[1],y=Object(c.useState)(0),S=Object(r.a)(y,2),C=S[0],_=S[1],N=Object(c.useState)(localStorage.getItem("lastPSRT")?b(localStorage.getItem("lastPSRT")||""):function(e){var t={},n=new XMLHttpRequest;return n.open("GET",e,!1),n.onreadystatechange=function(){4===n.readyState&&(200!==n.status&&0!=n.status||(t=Object(o.a)({},b(n.responseText))))},n.send(null),t}("assets/kaifuku_32.psrt")),k=Object(r.a)(N,2),I=k[0],w=k[1],L=Object(c.useState)(localStorage.getItem("lastPage")||"page1"),P=Object(r.a)(L,2),T=P[0],z=P[1],E=function(e){e.preventDefault(),g(!0),p((e.clientX-e.target.offsetLeft)/e.target.offsetWidth*100),e.target.offsetTop>=e.clientY&&_((e.clientY-e.target.offsetTop)/e.target.clientHeight*100)},R=Object(c.useState)({}),G=Object(r.a)(R,2),J=G[0],A=G[1];return Object(c.useEffect)((function(){var e,t;(localStorage.setItem("lastPage",T),null===I||void 0===I||null===(e=I.__image_link__)||void 0===e?void 0:e[T])&&l(null===I||void 0===I||null===(t=I.__image_link__)||void 0===t?void 0:t[T])}),[T]),Object(c.useEffect)((function(){localStorage.setItem("lastImage",n)}),[n]),Object(a.jsxs)("div",{className:"App container mb-6",style:{display:"flex"},children:[Object(a.jsx)(F,{sub:I,setSub:w,page:T,setPage:z,setImage:l,image:n,setImageStyle:d,setEditStyles:A,mouse:{x:v,y:C},setMouseImageClick:g,mouseImageClick:f}),Object(a.jsxs)("div",{className:"mb-5 mt-5 ml-5 pl-5 justify-content-end col",children:[Object(a.jsx)(j,{editStyles:J,style:Object(o.a)({width:"600px"},u),imgPath:n,page:T,subtitle:I,onClick:E}),Object(a.jsx)(j,{style:Object(o.a)({width:"1000px"},u),editStyles:J,imgPath:n,page:T,subtitle:I,onClick:E})]})]})},T=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,67)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,l=t.getLCP,i=t.getTTFB;n(e),a(e),c(e),l(e),i(e)}))};s.a.render(Object(a.jsx)(l.a.StrictMode,{children:Object(a.jsx)(P,{})}),document.getElementById("root")),T()}},[[58,1,2]]]);
//# sourceMappingURL=main.4f9f7bd0.chunk.js.map