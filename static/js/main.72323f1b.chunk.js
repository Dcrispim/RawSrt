(this.webpackJsonpsrt2=this.webpackJsonpsrt2||[]).push([[0],{46:function(e,t,n){},47:function(e,t,n){},53:function(e,t,n){"use strict";n.r(t);var a=n(2),c=n(0),l=n.n(c),i=n(21),o=n.n(i),r=(n(46),n(7)),s=n(8),u=(n(47),n(28)),d=function(e){var t=e.text,n=e.x,c=e.y,l=e.width,i=e.size,o=e.style,s=e.id,u=e.globalStyle,d=e.editStyles;return Object(a.jsx)("p",{id:"".concat(s),style:Object(r.a)(Object(r.a)(Object(r.a)({position:"absolute",top:"".concat(c,"%"),left:"".concat(n,"%"),width:"".concat(l,"%"),fontSize:"".concat(i,"px")},o),u),d),children:t})},b=function(e){var t,n=e.imgPath,l=e.subtitle,i=e.page,o=e.editStyles,b=Object(u.a)(e,["imgPath","subtitle","page","editStyles"]),j=Object(c.useRef)(null),O=Object(c.useState)(0),f=Object(s.a)(O,2),v=f[0],h=f[1],g=Object(c.useState)(0),p=Object(s.a)(g,2),m=p[0],x=p[1],y=Object(c.useState)(0),S=Object(s.a)(y,2),_=S[0],C=S[1],k=Object(c.useState)(0),I=Object(s.a)(k,2),w=I[0],N=I[1],F=function(){var e,t,n,a;h(null===(e=j.current)||void 0===e?void 0:e.offsetTop),x(null===(t=j.current)||void 0===t?void 0:t.offsetLeft),C(null===(n=j.current)||void 0===n?void 0:n.offsetHeight),N(null===(a=j.current)||void 0===a?void 0:a.offsetWidth)};return Object(c.useEffect)((function(){return window.addEventListener("resize",F),function(){window.removeEventListener("resize",F)}}),[]),console.log(l),Object(a.jsxs)("div",{children:[Object(a.jsx)("div",{style:{position:"absolute",zIndex:11,top:v,left:m,width:w,height:_},children:null===(t=l[i])||void 0===t?void 0:t.sort((function(e,t){return e.index-t.index})).map((function(e){var t,n=e.text,c=e.x,r=e.y,s=e.width,u=e.size,b=e.style,j=e.index;return Object(a.jsx)(d,{id:j,text:n,globalStyle:l.__global_style__,editStyles:null===o||void 0===o||null===(t=o[i])||void 0===t?void 0:t[j],x:c,y:r,width:s,size:u*w/100,style:b},j)}))}),Object(a.jsx)("img",Object(r.a)({onLoad:F,ref:j,src:(null===l||void 0===l?void 0:l.__image_link__[i])||n,alt:i},b))]})},j=function(e){var t={},n="",a=0,c=0;return e.split("\n").map((function(e){if(e.includes("$START"))n=e.substring(6).trim().split("|")[0],t[n]=[],e.substring(6).trim().split("|")[1]&&(t.__global_style__=JSON.parse(e.substring(6).trim().split("|")[1])),e.substring(6).trim().split("|")[2]&&(Object.keys(t).includes("__image_link__")||(t.__image_link__={}),t.__image_link__[n]=e.substring(6).trim().split("|")[2]);else if(e.includes("$END"))n="";else if(e.includes(">>")){var l,i,o=e.substring(2),r=o.split("|")[0].split("-"),u=Object(s.a)(r,4),d=u[0],b=u[1],j=u[2],O=u[3];null===(l=t[n])||void 0===l||l.push({index:o.split("|")[2]?parseInt(o.split("|")[2]):c+a,x:parseFloat(d),y:parseFloat(b),size:parseFloat(j),width:parseFloat(O),style:JSON.parse(null===(i=o.split("|"))||void 0===i?void 0:i[1])}),c=o.split("|")[2]?parseInt(o.split("|")[2]):c,a+=1}else if(e.length>1){var f,v;if((null===(f=t[n])||void 0===f?void 0:f.length)>0)t[n][(null===(v=t[n])||void 0===v?void 0:v.length)-1].text=e}})),t},O=n(33),f=n(12),v=n(61),h=n(58),g=n(36),p=n(59),m=n(40),x=n(35),y=n(60),S=n(34),_="#0f04",C=function(e){var t=e.placeholder,n=e.value,c=e.onChange,l=e.className,i=void 0===l?"":l,o=Object(u.a)(e,["placeholder","value","onChange","className"]);return Object(a.jsx)(y.a,{className:"mb-3 "+i,children:Object(a.jsx)(S.a,Object(r.a)({placeholder:t,"aria-label":t,"aria-describedby":"basic-addon1",onChange:function(e){return c(e.target.value)},value:n},o))})};function k(e,t,n){var a=new Blob([e],{type:n});if(window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(a,t);else{var c=document.createElement("a"),l=URL.createObjectURL(a);c.href=l,c.download=t,document.body.appendChild(c),c.click(),setTimeout((function(){document.body.removeChild(c),window.URL.revokeObjectURL(l)}),0)}}var I=function(e){return function(t){var n=t.target.files;if(FileReader&&n&&n.length){var a=new FileReader;a.onload=function(){return e(a)},a.readAsDataURL(n[0])}}},w=function(e){return function(t){var n=t.target.files;if(FileReader&&n&&n.length){var a=new FileReader;a.onload=function(){return e(a)},a.readAsText(n[0])}}},N=function(e){var t,n,l,i=e.sub,o=e.setSub,u=e.page,d=e.setPage,b=e.setImage,y=e.image,S=(e.setImageStyle,e.setEditStyles),N=Object(c.useState)(u||"page1"),F=Object(s.a)(N,2),L=F[0],T=F[1],R=Object(c.useState)(!1),z=Object(s.a)(R,2),P=z[0],E=z[1],G=Object(c.useState)(1),A=Object(s.a)(G,2),D=A[0],J=A[1],Y=Object(c.useState)(0),B=Object(s.a)(Y,2),U=B[0],X=B[1],W=Object(c.useState)(0),$=Object(s.a)(W,2),H=$[0],K=$[1],M=Object(c.useState)(0),q=Object(s.a)(M,2),V=q[0],Q=q[1],Z=Object(c.useState)(0),ee=Object(s.a)(Z,2),te=ee[0],ne=ee[1],ae=Object(c.useState)(""),ce=Object(s.a)(ae,2),le=ce[0],ie=ce[1],oe=Object(c.useState)(!0),re=Object(s.a)(oe,2),se=re[0],ue=re[1],de=Object(c.useState)({}),be=Object(s.a)(de,2),je=be[0],Oe=be[1],fe=Object(c.useState)(""),ve=Object(s.a)(fe,2),he=ve[0],ge=ve[1],pe=Object(c.useState)(""),me=Object(s.a)(pe,2),xe=me[0],ye=me[1],Se=Object(c.useState)("sub"),_e=Object(s.a)(Se,2),Ce=_e[0],ke=_e[1],Ie=Object(c.useState)((null===(t=i["".concat(L)])||void 0===t?void 0:t.reduce((function(e,t){return t.index>e?t.index:e}),0))+1),we=Object(s.a)(Ie,2),Ne=we[0],Fe=we[1];Object(c.useEffect)((function(){!function(){if(S(Object(f.a)({},L,Object(f.a)({},D,{boderStyle:"solid",borderColor:_,borderWidth:"4px"}))),Object.keys(i).includes(L))try{o((function(e){var t;return Object(r.a)(Object(r.a)({},e),{},Object(f.a)({},L,Object(O.a)(null===(t=e[L])||void 0===t?void 0:t.map((function(e){return e.index===parseInt(String(D))?Object(r.a)(Object(r.a)({},e),{},{x:parseFloat(U),y:parseFloat(H),width:parseFloat(V),size:parseFloat(te),text:le,style:Object(r.a)({},je)}):e})))))}))}catch(e){console.log(e)}}()}),[U,H,V,te,le,je,u]);var Le=function(e){if(L){var t,n=null===(t=(e||i)[L])||void 0===t?void 0:t.find((function(e){return e.index===parseInt(String(D))}));X((function(e){return(null===n||void 0===n?void 0:n.x)||e})),K((function(e){return(null===n||void 0===n?void 0:n.y)||e})),Q((function(e){return(null===n||void 0===n?void 0:n.width)||e})),ne((function(e){return(null===n||void 0===n?void 0:n.size)||e})),ie((null===n||void 0===n?void 0:n.text)||""),Oe((function(e){return(null===n||void 0===n?void 0:n.style)?Object(r.a)({},null===n||void 0===n?void 0:n.style):Object(r.a)({},e)}))}};return Object(c.useEffect)((function(){Le()}),[D,L]),Object(c.useEffect)((function(){var e;E(!Object.keys(i).includes(L)),Object.keys(i).includes(L)&&d(L),Fe((null===(e=i[L])||void 0===e?void 0:e.reduce((function(e,t){var n=t.index;return n>e?n:e}),0))+1)}),[L]),Object(a.jsxs)(v.a,{style:{position:"fixed",width:"500px",left:0,overflowY:"auto",overflowX:"hidden",zIndex:50},children:[Object(a.jsxs)("div",{className:"form-check form-switch mr-0",children:[Object(a.jsx)("input",{className:"form-check-input",type:"checkbox",onClick:function(){return ue((function(e){return!e}))},id:"flexSwitchCheckChecked",checked:se}),Object(a.jsx)("label",{className:"form-check-label",htmlFor:"flexSwitchCheckChecked",children:"Settings"})]}),se&&Object(a.jsxs)("div",{children:[Object(a.jsxs)(h.a,{className:"mb-2",children:[Object(a.jsxs)(v.a.Group,{className:" col-4 mb-0",controlId:"subtitle-file",children:[Object(a.jsx)(v.a.Label,{className:"btn btn-primary",children:"Load Image"}),Object(a.jsx)(v.a.Control,{readOnly:!0,onChange:I((function(e){localStorage.setItem("lastImage",String(e.result)),b(String(e.result))})),type:"file",style:{visibility:"hidden",height:"0px"},placeholder:"Image"})]}),Object(a.jsxs)(v.a.Group,{className:" col-4 mb-0",controlId:"image-file",children:[Object(a.jsx)(v.a.Label,{className:"btn btn-primary",children:"Load SubTitle"}),Object(a.jsx)(v.a.Control,{readOnly:!0,onChange:w((function(e){var t;localStorage.setItem("lastPSRT",String(e.result));var n=j(String(e.result));o(n),Fe((null===(t=n[L])||void 0===t?void 0:t.reduce((function(e,t){var n=t.index;return n>e?n:e}),0))+1),Le(n)})),type:"file",style:{visibility:"hidden",height:"0px"},placeholder:"Image"})]}),Object(a.jsx)(g.a,{className:" col-2",onClick:function(){o({page1:[]}),T("page1"),J(0),Fe(0)},variant:"danger",children:"Clear All"}),Object(a.jsx)(C,{className:"mt-2 col-12",value:(null===y||void 0===y?void 0:y.includes("base64"))?"File":y,placeholder:"Image Link",onChange:function(e){b((function(t){return"File"===e?t:(n=L,a=e,o((function(e){return Object(r.a)(Object(r.a)({},e),{},{__image_link__:Object(r.a)(Object(r.a)({},null===e||void 0===e?void 0:e.__image_link__),{},Object(f.a)({},n,a))})})),e);var n,a}))}})]}),Object(a.jsxs)(h.a,{style:{alignItems:"flex-end"},children:[Object(a.jsxs)(v.a.Group,{className:" col-3 mb-0",controlId:"formPage",children:[Object(a.jsx)(v.a.Label,{children:"Page"}),Object(a.jsx)(v.a.Control,{value:L,onChange:function(e){return T(e.target.value)},placeholder:"Page"})]}),Object(a.jsx)(g.a,{className:" col-2",onClick:function(){P&&(o(Object(r.a)(Object(r.a)({},i),{},Object(f.a)({},L,[{index:parseInt(String(0)),x:parseFloat(String(U)),y:parseFloat(String(H)),width:parseFloat(String(V)),size:parseFloat(String(te)),text:le,style:Object(r.a)(Object(r.a)({},je),{},{backgroundColor:_})}]))),Le(i),J(0),Fe(1),d(L),Le())},disabled:!P,variant:"primary",children:"Add page"}),Object(a.jsxs)(v.a.Group,{className:" col-3 mb-0",controlId:"formIndex",children:[Object(a.jsx)(v.a.Label,{children:"Index"}),Object(a.jsx)(v.a.Control,{value:D,onChange:function(e){return J(e.target.value)},type:"number",min:"0",max:null===(n=i[String(L)])||void 0===n?void 0:n.length,step:"1",placeholder:"index"})]}),Object(a.jsx)(g.a,{className:" col-2",onClick:function(){o((function(e){return Object(r.a)(Object(r.a)({},e),{},Object(f.a)({},L,[].concat(Object(O.a)(e[L]),[{index:parseInt(String(Ne)),x:parseFloat(String(U)),y:parseFloat(String(H)),width:parseFloat(String(V)),size:parseFloat(String(te)),text:le,style:Object(r.a)(Object(r.a)({},je),{},{backgroundColor:_})}])))})),J(Ne),Fe((function(e){return e+1}))},variant:"primary",children:"Add Text"})]}),Object(a.jsxs)(h.a,{children:[Object(a.jsxs)(v.a.Group,{className:" col-3",controlId:"formX",children:[Object(a.jsx)(v.a.Label,{children:"X axis"}),Object(a.jsx)(v.a.Control,{value:U,onChange:function(e){return X(e.target.value)},type:"number",min:"0",max:"100",step:"0.1",placeholder:"X"})]}),Object(a.jsxs)(v.a.Group,{className:" col-3",controlId:"formY",children:[Object(a.jsx)(v.a.Label,{children:"Y axis"}),Object(a.jsx)(v.a.Control,{value:H,onChange:function(e){return K(e.target.value)},type:"number",min:"0",max:"100",step:"0.1",placeholder:"Y"})]}),Object(a.jsxs)(v.a.Group,{className:" col-3",controlId:"formY",children:[Object(a.jsx)(v.a.Label,{children:"Size"}),Object(a.jsx)(v.a.Control,{value:te,onChange:function(e){return ne(e.target.value)},type:"number",min:"0",max:"100",step:"0.1",placeholder:"size"})]}),Object(a.jsxs)(v.a.Group,{className:" col-3",controlId:"formWidth",children:[Object(a.jsx)(v.a.Label,{children:"Width"}),Object(a.jsx)(v.a.Control,{value:V,onChange:function(e){return Q(e.target.value)},type:"number",min:"0",max:"100",step:"0.1",placeholder:"width"})]})]}),Object(a.jsxs)(h.a,{children:[Object(a.jsxs)(v.a.Group,{className:" col-8",controlId:"formText",children:[Object(a.jsx)(v.a.Label,{children:"Text"}),Object(a.jsx)(v.a.Control,{value:le,onChange:function(e){return ie(e.target.value)},type:"text",placeholder:"width"})]}),Object.keys(je).length>0&&Object(a.jsx)(p.a,{className:"col-4",variant:"secondary",id:"dropdown-basic-button",title:"Styles",children:Object.keys(je).length>0&&(null===(l=Object.keys(je))||void 0===l?void 0:l.map((function(e){return Object(a.jsx)(m.a.Item,{onClick:function(){return function(e){ye(je[e]),ge(e);var t=Object(r.a)({},je);delete t[e],Oe(t)}(e)},children:"".concat(e.replaceAll("_"," ")," : ").concat(je[e])},e)})))})]}),Object(a.jsxs)(h.a,{children:[Object(a.jsx)(v.a.Group,{className:" col-4",controlId:"formKeyStyle",children:Object(a.jsx)(v.a.Control,{value:he,onChange:function(e){return ge(e.target.value)},type:"text",placeholder:"key"})}),Object(a.jsx)(v.a.Group,{className:" col-4",controlId:"formValueStyle",children:Object(a.jsx)(v.a.Control,{value:xe,onChange:function(e){return ye(e.target.value)},type:"text",placeholder:"value"})}),Object(a.jsx)(g.a,{style:{height:"100%"},className:"p-2 col-4 btn-secondary",onClick:function(){Oe((function(e){return Object(r.a)(Object(r.a)({},e),{},Object(f.a)({},he,xe))})),ye(""),ge("")},children:"Add Style"})]}),Object(a.jsxs)(h.a,{children:[Object(a.jsxs)(v.a.Group,{className:" col-6",controlId:"formDownload",children:[Object(a.jsx)(v.a.Label,{children:"Download Subtitle"}),Object(a.jsx)(v.a.Control,{value:Ce,onChange:function(e){return ke(e.target.value)},placeholder:"Download Subtitle"})]}),Object(a.jsxs)(x.a,{className:" col-6",children:[Object(a.jsx)(g.a,{className:" col-12 mb-2",disabled:!Ce,onClick:function(){return k(function(e){var t="";return Object.keys(e).filter((function(e){return!e.includes("__")})).map((function(n){var a;t+="$START ".concat(n,"|").concat(JSON.stringify((null===e||void 0===e?void 0:e.__global_style__)||{}),"|").concat(null===e||void 0===e?void 0:e.__image_link__[n],"\n"),null===(a=e[n])||void 0===a||a.map((function(e,n){var a=e.x,c=e.y,l=e.size,i=e.width,o=e.text,r=e.style,s=e.index;t+=">>".concat(a,"-").concat(c,"-").concat(l,"-").concat(i,"|").concat(JSON.stringify(r),"|").concat(s||n,"\n"),t+="".concat(o,"\n\n")})),t+="$END ".concat(n,"\n\n")})),t}(i),"".concat(Ce,".psrt"),"*.psrt")},variant:"primary",children:"(.psrt)"}),Object(a.jsx)(g.a,{className:" col-12",disabled:!Ce,onClick:function(){return k(JSON.stringify(i),"".concat(Ce,".json"),"*.json")},variant:"primary",children:"(.json)"})]})]})]})]})};n(52);var F=function(){var e=Object(c.useState)(localStorage.getItem("lastImage")||""),t=Object(s.a)(e,2),n=t[0],l=t[1],i=Object(c.useState)({}),o=Object(s.a)(i,2),u=o[0],d=o[1],O=Object(c.useState)(localStorage.getItem("lastPSRT")?j(localStorage.getItem("lastPSRT")||""):function(e){var t={},n=new XMLHttpRequest;return n.open("GET",e,!1),n.onreadystatechange=function(){4===n.readyState&&(200!==n.status&&0!=n.status||(t=Object(r.a)({},j(n.responseText))))},n.send(null),t}("assets/kaifuku_32.psrt")),f=Object(s.a)(O,2),v=f[0],h=f[1],g=Object(c.useState)(localStorage.getItem("lastPage")||"page1"),p=Object(s.a)(g,2),m=p[0],x=p[1],y=Object(c.useState)({}),S=Object(s.a)(y,2),_=S[0],C=S[1];return Object(c.useEffect)((function(){var e,t;(localStorage.setItem("lastPage",m),null===v||void 0===v||null===(e=v.__image_link__)||void 0===e?void 0:e[m])&&l(null===v||void 0===v||null===(t=v.__image_link__)||void 0===t?void 0:t[m])}),[m]),Object(c.useEffect)((function(){localStorage.setItem("lastImage",n)}),[n]),Object(a.jsxs)("div",{className:"App container",style:{display:"flex"},children:[Object(a.jsx)(N,{sub:v,setSub:h,page:m,setPage:x,setImage:l,image:n,setImageStyle:d,setEditStyles:C}),Object(a.jsxs)("div",{children:[Object(a.jsx)(b,{editStyles:_,imgPath:n,subtitle:v,src:"assets/Kaifuku-Jutsushi-Yarinaoshi_-_32_-_Darkyue-Realm/img_or3001211824_0002.jpg"}),Object(a.jsx)(b,{style:Object(r.a)({width:"1300px"},u),editStyles:_,imgPath:n,page:m,subtitle:v})]})]})},L=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,62)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,l=t.getLCP,i=t.getTTFB;n(e),a(e),c(e),l(e),i(e)}))};o.a.render(Object(a.jsx)(l.a.StrictMode,{children:Object(a.jsx)(F,{})}),document.getElementById("root")),L()}},[[53,1,2]]]);
//# sourceMappingURL=main.72323f1b.chunk.js.map