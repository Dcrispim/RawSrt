{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/home/intelie/Documents/srt2/src/cmponents/EditSub.tsx\",\n    _s = $RefreshSig$();\n\n/* eslint-disable react/jsx-no-undef */\nimport React, { useEffect, useState } from \"react\";\nimport { Form, Button, DropdownButton, Dropdown, Row } from \"react-bootstrap\";\nimport { parseObjectToPSRT, parsePSRTToObject } from \"../service/subtitle\"; //import DragScaleBar from 'react-drag-scale-bar'\n// import { Container } from './styles';\n\nconst EditSub = ({\n  sub,\n  setSub,\n  page,\n  setImage,\n  setImageStyle\n}) => {\n  _s();\n\n  var _Object$keys;\n\n  const [index, setIndex] = useState(1);\n  const [x, setX] = useState(0);\n  const [y, setY] = useState(0);\n  const [width, setWidth] = useState(0);\n  const [size, setSize] = useState(0);\n  const [subText, setSubText] = useState(\"\");\n  const [show, setShow] = useState(true);\n  const [style, setStyle] = useState({});\n  const [keyStyle, setKeyStyle] = useState(\"\");\n  const [valueStyle, setValueStyle] = useState(\"\");\n\n  const handleChangeSub = () => {\n    if (page) {\n      setSub(data => {\n        var _sub$page;\n\n        return { ...data,\n          [page]: [...((_sub$page = sub[page]) === null || _sub$page === void 0 ? void 0 : _sub$page.map(txt => {\n            if (txt.index === parseInt(index)) {\n              return { ...txt,\n                x: parseFloat(x),\n                y: parseFloat(y),\n                width: parseFloat(width),\n                size: parseFloat(size),\n                text: subText,\n                style: { ...style,\n                  backgroundColor: \"#0f0\"\n                }\n              };\n            } else {\n              if (txt.style.backgroundColor === \"#0f0\") {\n                delete txt.style.backgroundColor;\n              }\n\n              return txt;\n            }\n          }))]\n        };\n      });\n    }\n  };\n\n  useEffect(() => {\n    console.log(\"update\");\n    console.log(style);\n    handleChangeSub();\n  }, [x, y, width, size, subText, style]);\n\n  const updateSubInfos = newSub => {\n    const _sub = newSub || sub;\n\n    if (page) {\n      var _sub$page2;\n\n      const text = (_sub$page2 = _sub[page]) === null || _sub$page2 === void 0 ? void 0 : _sub$page2.find(a => a.index === parseInt(index));\n      setX((text === null || text === void 0 ? void 0 : text.x) || x);\n      setY((text === null || text === void 0 ? void 0 : text.y) || y);\n      setWidth((text === null || text === void 0 ? void 0 : text.width) || width);\n      setSize((text === null || text === void 0 ? void 0 : text.size) || size);\n      setSubText((text === null || text === void 0 ? void 0 : text.text) || subText);\n      setStyle({ ...(text === null || text === void 0 ? void 0 : text.style)\n      } || { ...style\n      });\n    }\n  };\n\n  useEffect(() => {\n    updateSubInfos();\n  }, [index]);\n\n  function download(data, filename, type) {\n    var file = new Blob([data], {\n      type: type\n    });\n    if (window.navigator.msSaveOrOpenBlob) // IE10+\n      window.navigator.msSaveOrOpenBlob(file, filename);else {\n      // Others\n      var a = document.createElement(\"a\"),\n          url = URL.createObjectURL(file);\n      a.href = url;\n      a.download = filename;\n      document.body.appendChild(a);\n      a.click();\n      setTimeout(function () {\n        document.body.removeChild(a);\n        window.URL.revokeObjectURL(url);\n      }, 0);\n    }\n  }\n\n  const formatSub = sub => {\n    if (page) {\n      sub[page].map(txt => {\n        if (txt.style.backgroundColor === \"#0f0\") {\n          delete txt.style.backgroundColor;\n        }\n\n        return txt;\n      });\n    }\n\n    return sub;\n  };\n\n  const getLocalImage = callback => evt => {\n    let tgt = evt.target;\n    let files = tgt.files; // FileReader support\n\n    if (FileReader && files && files.length) {\n      let fr = new FileReader();\n\n      fr.onload = () => callback(fr);\n\n      fr.readAsDataURL(files[0]);\n    }\n  };\n\n  const getLocalSubtitle = callback => evt => {\n    let tgt = evt.target;\n    let files = tgt.files; // FileReader support\n\n    if (FileReader && files && files.length) {\n      let fr = new FileReader();\n\n      fr.onload = () => callback(fr);\n\n      fr.readAsText(files[0]);\n    }\n  };\n\n  const updateSubtitleFile = fr => {\n    const newSub = parsePSRTToObject(String(fr.result));\n    setSub(newSub);\n    updateSubInfos(newSub);\n  };\n\n  const showImage = fr => setImage(fr.result);\n\n  const handleAddStyle = () => {\n    setStyle(old => ({ ...old,\n      [keyStyle]: valueStyle\n    }));\n    setValueStyle(\"\");\n    setKeyStyle(\"\");\n  };\n\n  const handleRemoveStyle = key => {\n    setValueStyle(style[key]);\n    setKeyStyle(key);\n    const newStyles = { ...style\n    };\n    console.log(newStyles);\n    delete newStyles[key];\n    console.log(newStyles);\n    setStyle(newStyles);\n  };\n\n  return /*#__PURE__*/_jsxDEV(Form, {\n    style: {\n      position: \"fixed\",\n      left: 0,\n      overflowY: \"scroll\",\n      zIndex: 50\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: `form-check form-switch ${!show ? \"ml-5\" : \"\"}`,\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        className: \"form-check-input\",\n        type: \"checkbox\",\n        onClick: () => setShow(a => !a),\n        id: \"flexSwitchCheckChecked\",\n        checked: show\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 181,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        className: \"form-check-label\",\n        htmlFor: \"flexSwitchCheckChecked\",\n        children: \"Settings\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 188,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 180,\n      columnNumber: 7\n    }, this), show && /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(Form.Group, {\n        controlId: \"subtitle-file\",\n        children: [/*#__PURE__*/_jsxDEV(Form.Label, {\n          className: \"btn btn-primary\",\n          children: \"Load Image\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 195,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Form.Control, {\n          onChange: getLocalImage(showImage),\n          type: \"file\",\n          style: {\n            visibility: \"hidden\"\n          },\n          placeholder: \"Image\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 196,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 194,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(Form.Group, {\n        controlId: \"image-file\",\n        children: [/*#__PURE__*/_jsxDEV(Form.Label, {\n          className: \"btn btn-primary\",\n          children: \"Load SubTitle\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 205,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Form.Control, {\n          onChange: getLocalSubtitle(updateSubtitleFile),\n          type: \"file\",\n          style: {\n            visibility: \"hidden\"\n          },\n          placeholder: \"Image\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 206,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 204,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(Form.Group, {\n        controlId: \"formIndex\",\n        children: [/*#__PURE__*/_jsxDEV(Form.Label, {\n          children: \"Index\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 215,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Form.Control, {\n          value: index,\n          onChange: e => setIndex(e.target.value),\n          type: \"number\",\n          min: \"0\",\n          step: \"1\",\n          placeholder: \"index\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 216,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 214,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(Row, {\n        children: [/*#__PURE__*/_jsxDEV(Form.Group, {\n          controlId: \"formX\",\n          children: [/*#__PURE__*/_jsxDEV(Form.Label, {\n            children: \"X axis\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 227,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Form.Control, {\n            value: x,\n            onChange: e => setX(e.target.value),\n            type: \"number\",\n            min: \"0\",\n            max: \"100\",\n            step: \"0.1\",\n            placeholder: \"X\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 228,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 226,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Form.Group, {\n          controlId: \"formY\",\n          children: [/*#__PURE__*/_jsxDEV(Form.Label, {\n            children: \"Y axis\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 240,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Form.Control, {\n            value: y,\n            onChange: e => setY(e.target.value),\n            type: \"number\",\n            min: \"0\",\n            max: \"100\",\n            step: \"0.1\",\n            placeholder: \"Y\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 241,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 239,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 225,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(Form.Group, {\n        controlId: \"formY\",\n        children: [/*#__PURE__*/_jsxDEV(Form.Label, {\n          children: \"Size\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 253,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Form.Control, {\n          value: size,\n          onChange: e => setSize(e.target.value),\n          type: \"number\",\n          min: \"0\",\n          max: \"100\",\n          step: \"0.1\",\n          placeholder: \"size\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 254,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 252,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(Form.Group, {\n        controlId: \"formWidth\",\n        children: [/*#__PURE__*/_jsxDEV(Form.Label, {\n          children: \"Width\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 265,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Form.Control, {\n          value: width,\n          onChange: e => setWidth(e.target.value),\n          type: \"number\",\n          min: \"0\",\n          max: \"100\",\n          step: \"0.1\",\n          placeholder: \"width\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 266,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 264,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(Form.Group, {\n        controlId: \"formText\",\n        children: [/*#__PURE__*/_jsxDEV(Form.Label, {\n          children: \"Text\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 278,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Form.Control, {\n          value: subText,\n          onChange: e => setSubText(e.target.value),\n          type: \"text\",\n          placeholder: \"width\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 279,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 277,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(Row, {\n        children: [/*#__PURE__*/_jsxDEV(Row, {\n          children: [/*#__PURE__*/_jsxDEV(Form.Group, {\n            className: \" col-2\",\n            controlId: \"formKeyStyle\",\n            children: /*#__PURE__*/_jsxDEV(Form.Control, {\n              value: keyStyle,\n              onChange: e => setKeyStyle(e.target.value),\n              type: \"text\",\n              placeholder: \"key\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 289,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 288,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Form.Group, {\n            className: \" col-2\",\n            controlId: \"formValueStyle\",\n            children: /*#__PURE__*/_jsxDEV(Form.Control, {\n              value: valueStyle,\n              onChange: e => setValueStyle(e.target.value),\n              type: \"text\",\n              placeholder: \"value\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 297,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 296,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 287,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          className: \"mt-2 mb-3 col-sm btn-secondary\",\n          onClick: handleAddStyle,\n          children: \"Add Note\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 305,\n          columnNumber: 13\n        }, this), Object.keys(style).length > 0 && /*#__PURE__*/_jsxDEV(DropdownButton, {\n          className: \" m-2 col-sm\",\n          variant: \"secondary\",\n          id: \"dropdown-basic-button\",\n          title: \"Notes\",\n          children: Object.keys(style).length > 0 && ((_Object$keys = Object.keys(style)) === null || _Object$keys === void 0 ? void 0 : _Object$keys.map(styleProp => /*#__PURE__*/_jsxDEV(Dropdown.Item, {\n            onClick: () => handleRemoveStyle(styleProp),\n            children: `${styleProp.replaceAll(\"_\", \" \")} : ${style[styleProp]}`\n          }, styleProp, false, {\n            fileName: _jsxFileName,\n            lineNumber: 320,\n            columnNumber: 21\n          }, this)))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 312,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 286,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(Button, {\n          onClick: () => download(parseObjectToPSRT(formatSub(sub)), \"sub.psrt\", \"jpg\"),\n          variant: \"primary\",\n          children: \"Dowload Subtitle (.psrt)\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 333,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          onClick: () => download(JSON.stringify(formatSub(sub)), \"sub.json\", \"jpg\"),\n          variant: \"primary\",\n          children: \"Dowload Subtitle (.json)\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 341,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 332,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 193,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 177,\n    columnNumber: 5\n  }, this);\n};\n\n_s(EditSub, \"QK1HLD60WgqNUm50lzNutWwI91Y=\");\n\n_c = EditSub;\nexport default EditSub;\n\nvar _c;\n\n$RefreshReg$(_c, \"EditSub\");","map":{"version":3,"sources":["/home/intelie/Documents/srt2/src/cmponents/EditSub.tsx"],"names":["React","useEffect","useState","Form","Button","DropdownButton","Dropdown","Row","parseObjectToPSRT","parsePSRTToObject","EditSub","sub","setSub","page","setImage","setImageStyle","index","setIndex","x","setX","y","setY","width","setWidth","size","setSize","subText","setSubText","show","setShow","style","setStyle","keyStyle","setKeyStyle","valueStyle","setValueStyle","handleChangeSub","data","map","txt","parseInt","parseFloat","text","backgroundColor","console","log","updateSubInfos","newSub","_sub","find","a","download","filename","type","file","Blob","window","navigator","msSaveOrOpenBlob","document","createElement","url","URL","createObjectURL","href","body","appendChild","click","setTimeout","removeChild","revokeObjectURL","formatSub","getLocalImage","callback","evt","tgt","target","files","FileReader","length","fr","onload","readAsDataURL","getLocalSubtitle","readAsText","updateSubtitleFile","String","result","showImage","handleAddStyle","old","handleRemoveStyle","key","newStyles","position","left","overflowY","zIndex","visibility","e","value","Object","keys","styleProp","replaceAll","JSON","stringify"],"mappings":"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","sourcesContent":["/* eslint-disable react/jsx-no-undef */\nimport React, { useEffect, useState } from \"react\";\nimport { Form, Button, DropdownButton, Dropdown, Row } from \"react-bootstrap\";\nimport {\n  parseObjectToPSRT,\n  parsePSRTFileToObject,\n  parsePSRTToObject,\n} from \"../service/subtitle\";\n\n//import DragScaleBar from 'react-drag-scale-bar'\n// import { Container } from './styles';\ntype TypeUseState<T> = (a: T | ((a: T) => T)) => void;\ntype TypeSub = {\n  [page: string]: {\n    x: number;\n    y: number;\n    index: number;\n    width: number;\n    size: number;\n    text: string;\n    style: React.CSSProperties;\n  }[];\n};\nconst EditSub: React.FC<{\n  sub: TypeSub;\n  setSub: TypeUseState<TypeSub>;\n  page?: string;\n  setImage: TypeUseState<string>;\n  setImageStyle: TypeUseState<React.CSSProperties | string>;\n}> = ({ sub, setSub, page, setImage, setImageStyle }) => {\n  const [index, setIndex] = useState<string | number>(1);\n  const [x, setX] = useState<string | number>(0);\n  const [y, setY] = useState<string | number>(0);\n  const [width, setWidth] = useState<string | number>(0);\n  const [size, setSize] = useState<string | number>(0);\n  const [subText, setSubText] = useState(\"\");\n  const [show, setShow] = useState(true);\n  const [style, setStyle] = useState<{ [cssAttr: string]: string }>({});\n  const [keyStyle, setKeyStyle] = useState<string>(\"\");\n  const [valueStyle, setValueStyle] = useState<string>(\"\");\n\n  const handleChangeSub = () => {\n    if (page) {\n      setSub((data) => ({\n        ...data,\n        [page]: [\n          ...sub[page]?.map((txt) => {\n            if (txt.index === parseInt(index)) {\n              return {\n                ...txt,\n                x: parseFloat(x),\n                y: parseFloat(y),\n                width: parseFloat(width),\n                size: parseFloat(size),\n                text: subText,\n                style: {\n                  ...style,\n                  backgroundColor: \"#0f0\",\n                },\n              };\n            } else {\n              if (txt.style.backgroundColor === \"#0f0\") {\n                delete txt.style.backgroundColor;\n              }\n              return txt;\n            }\n          }),\n        ],\n      }));\n    }\n  };\n\n  useEffect(() => {\n    console.log(\"update\");\n    console.log(style);\n\n    handleChangeSub();\n  }, [x, y, width, size, subText, style]);\n\n  const updateSubInfos = (newSub?: TypeSub) => {\n    const _sub = newSub || sub;\n    if (page) {\n      const text = _sub[page]?.find((a) => a.index === parseInt(index));\n      setX(text?.x || x);\n      setY(text?.y || y);\n      setWidth(text?.width || width);\n      setSize(text?.size || size);\n      setSubText(text?.text || subText);\n      setStyle({ ...text?.style } || { ...style });\n    }\n  };\n  useEffect(() => {\n    updateSubInfos();\n  }, [index]);\n\n  function download(data, filename, type) {\n    var file = new Blob([data], { type: type });\n    if (window.navigator.msSaveOrOpenBlob)\n      // IE10+\n      window.navigator.msSaveOrOpenBlob(file, filename);\n    else {\n      // Others\n      var a = document.createElement(\"a\"),\n        url = URL.createObjectURL(file);\n      a.href = url;\n      a.download = filename;\n      document.body.appendChild(a);\n      a.click();\n      setTimeout(function () {\n        document.body.removeChild(a);\n        window.URL.revokeObjectURL(url);\n      }, 0);\n    }\n  }\n\n  const formatSub = (sub: TypeSub): TypeSub => {\n    if (page) {\n      sub[page].map((txt) => {\n        if (txt.style.backgroundColor === \"#0f0\") {\n          delete txt.style.backgroundColor;\n        }\n        return txt;\n      });\n    }\n    return sub;\n  };\n\n  const getLocalImage = (callback: (fr: FileReader) => any) => (evt) => {\n    let tgt = evt.target;\n    let files = tgt.files;\n\n    // FileReader support\n    if (FileReader && files && files.length) {\n      let fr = new FileReader();\n      fr.onload = () => callback(fr);\n      fr.readAsDataURL(files[0]);\n    }\n  };\n\n  const getLocalSubtitle = (callback: (fr: FileReader) => any) => (evt) => {\n    let tgt = evt.target;\n    let files = tgt.files;\n\n    // FileReader support\n    if (FileReader && files && files.length) {\n      let fr = new FileReader();\n      fr.onload = () => callback(fr);\n      fr.readAsText(files[0]);\n    }\n  };\n\n  const updateSubtitleFile = (fr: FileReader) => {\n    const newSub = parsePSRTToObject(String(fr.result));\n    setSub(newSub);\n    updateSubInfos(newSub);\n  };\n  const showImage = (fr: FileReader) => setImage(fr.result);\n\n  const handleAddStyle = () => {\n    setStyle((old) => ({ ...old, [keyStyle]: valueStyle }));\n    setValueStyle(\"\");\n    setKeyStyle(\"\");\n  };\n\n  const handleRemoveStyle = (key: string) => {\n    setValueStyle(style[key]);\n    setKeyStyle(key);\n    const newStyles = { ...style };\n    console.log(newStyles);\n\n    delete newStyles[key];\n    console.log(newStyles);\n    setStyle(newStyles);\n  };\n\n  return (\n    <Form\n      style={{ position: \"fixed\", left: 0, overflowY: \"scroll\", zIndex: 50 }}\n    >\n      <div className={`form-check form-switch ${!show ? \"ml-5\" : \"\"}`}>\n        <input\n          className=\"form-check-input\"\n          type=\"checkbox\"\n          onClick={() => setShow((a) => !a)}\n          id=\"flexSwitchCheckChecked\"\n          checked={show}\n        />\n        <label className=\"form-check-label\" htmlFor=\"flexSwitchCheckChecked\">\n          Settings\n        </label>\n      </div>\n      {show && (\n        <div>\n          <Form.Group controlId=\"subtitle-file\">\n            <Form.Label className=\"btn btn-primary\">Load Image</Form.Label>\n            <Form.Control\n              onChange={getLocalImage(showImage)}\n              type=\"file\"\n              style={{ visibility: \"hidden\" }}\n              placeholder=\"Image\"\n            />\n          </Form.Group>\n\n          <Form.Group controlId=\"image-file\">\n            <Form.Label className=\"btn btn-primary\">Load SubTitle</Form.Label>\n            <Form.Control\n              onChange={getLocalSubtitle(updateSubtitleFile)}\n              type=\"file\"\n              style={{ visibility: \"hidden\" }}\n              placeholder=\"Image\"\n            />\n          </Form.Group>\n\n          <Form.Group controlId=\"formIndex\">\n            <Form.Label>Index</Form.Label>\n            <Form.Control\n              value={index}\n              onChange={(e) => setIndex(e.target.value)}\n              type=\"number\"\n              min=\"0\"\n              step=\"1\"\n              placeholder=\"index\"\n            />\n          </Form.Group>\n          <Row>\n            <Form.Group controlId=\"formX\">\n              <Form.Label>X axis</Form.Label>\n              <Form.Control\n                value={x}\n                onChange={(e) => setX(e.target.value)}\n                type=\"number\"\n                min=\"0\"\n                max=\"100\"\n                step=\"0.1\"\n                placeholder=\"X\"\n              />\n            </Form.Group>\n\n            <Form.Group controlId=\"formY\">\n              <Form.Label>Y axis</Form.Label>\n              <Form.Control\n                value={y}\n                onChange={(e) => setY(e.target.value)}\n                type=\"number\"\n                min=\"0\"\n                max=\"100\"\n                step=\"0.1\"\n                placeholder=\"Y\"\n              />\n            </Form.Group>\n          </Row>\n          <Form.Group controlId=\"formY\">\n            <Form.Label>Size</Form.Label>\n            <Form.Control\n              value={size}\n              onChange={(e) => setSize(e.target.value)}\n              type=\"number\"\n              min=\"0\"\n              max=\"100\"\n              step=\"0.1\"\n              placeholder=\"size\"\n            />\n          </Form.Group>\n          <Form.Group controlId=\"formWidth\">\n            <Form.Label>Width</Form.Label>\n            <Form.Control\n              value={width}\n              onChange={(e) => setWidth(e.target.value)}\n              type=\"number\"\n              min=\"0\"\n              max=\"100\"\n              step=\"0.1\"\n              placeholder=\"width\"\n            />\n          </Form.Group>\n\n          <Form.Group controlId=\"formText\">\n            <Form.Label>Text</Form.Label>\n            <Form.Control\n              value={subText}\n              onChange={(e) => setSubText(e.target.value)}\n              type=\"text\"\n              placeholder=\"width\"\n            />\n          </Form.Group>\n          <Row>\n            <Row>\n              <Form.Group className=\" col-2\" controlId=\"formKeyStyle\">\n                <Form.Control\n                  value={keyStyle}\n                  onChange={(e) => setKeyStyle(e.target.value)}\n                  type=\"text\"\n                  placeholder=\"key\"\n                />\n              </Form.Group>\n              <Form.Group className=\" col-2\" controlId=\"formValueStyle\">\n                <Form.Control\n                  value={valueStyle}\n                  onChange={(e) => setValueStyle(e.target.value)}\n                  type=\"text\"\n                  placeholder=\"value\"\n                />\n              </Form.Group>\n            </Row>\n            <Button\n              className=\"mt-2 mb-3 col-sm btn-secondary\"\n              onClick={handleAddStyle}\n            >\n              Add Note\n            </Button>\n            {Object.keys(style).length > 0 && (\n              <DropdownButton\n                className=\" m-2 col-sm\"\n                variant=\"secondary\"\n                id=\"dropdown-basic-button\"\n                title=\"Notes\"\n              >\n                {Object.keys(style).length > 0 &&\n                  Object.keys(style)?.map((styleProp) => (\n                    <Dropdown.Item\n                      onClick={() => handleRemoveStyle(styleProp)}\n                      key={styleProp}\n                    >\n                      {`${styleProp.replaceAll(\"_\", \" \")} : ${\n                        style[styleProp]\n                      }`}\n                    </Dropdown.Item>\n                  ))}\n              </DropdownButton>\n            )}\n          </Row>\n          <div>\n            <Button\n              onClick={() =>\n                download(parseObjectToPSRT(formatSub(sub)), \"sub.psrt\", \"jpg\")\n              }\n              variant=\"primary\"\n            >\n              Dowload Subtitle (.psrt)\n            </Button>\n            <Button\n              onClick={() =>\n                download(JSON.stringify(formatSub(sub)), \"sub.json\", \"jpg\")\n              }\n              variant=\"primary\"\n            >\n              Dowload Subtitle (.json)\n            </Button>\n          </div>\n        </div>\n      )}\n    </Form>\n  );\n};\n\nexport default EditSub;\n"]},"metadata":{},"sourceType":"module"}