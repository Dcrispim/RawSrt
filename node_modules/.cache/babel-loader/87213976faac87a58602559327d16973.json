{"ast":null,"code":"import{jsxs as _jsxs}from\"react/jsx-runtime\";import _objectSpread from\"/home/intelie/Documents/srt2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import{jsx as _jsx}from\"react/jsx-runtime\";import _slicedToArray from\"/home/intelie/Documents/srt2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _objectWithoutProperties from\"/home/intelie/Documents/srt2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";import React,{useEffect,useRef,useState}from\"react\";var ImageSubTittle=function ImageSubTittle(_ref){var _subtitle$page;var imgPath=_ref.imgPath,subtitle=_ref.subtitle,page=_ref.page,editStyles=_ref.editStyles,props=_objectWithoutProperties(_ref,[\"imgPath\",\"subtitle\",\"page\",\"editStyles\"]);var imgRef=useRef(null);var _useState=useState(0),_useState2=_slicedToArray(_useState,2),subY=_useState2[0],setSubY=_useState2[1];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),subX=_useState4[0],setSubX=_useState4[1];var _useState5=useState(0),_useState6=_slicedToArray(_useState5,2),subH=_useState6[0],setSubH=_useState6[1];var _useState7=useState(0),_useState8=_slicedToArray(_useState7,2),subW=_useState8[0],setSubW=_useState8[1];var updateSubs=function updateSubs(){var _imgRef$current,_imgRef$current2,_imgRef$current3,_imgRef$current4;setSubY((_imgRef$current=imgRef.current)===null||_imgRef$current===void 0?void 0:_imgRef$current.offsetTop);setSubX((_imgRef$current2=imgRef.current)===null||_imgRef$current2===void 0?void 0:_imgRef$current2.offsetLeft);setSubH((_imgRef$current3=imgRef.current)===null||_imgRef$current3===void 0?void 0:_imgRef$current3.offsetHeight);setSubW((_imgRef$current4=imgRef.current)===null||_imgRef$current4===void 0?void 0:_imgRef$current4.offsetWidth);};useEffect(function(){window.addEventListener(\"resize\",updateSubs);return function(){window.removeEventListener(\"resize\",updateSubs);};},[]);return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{style:{position:\"absolute\",zIndex:11,top:subY,left:subX,width:subW,height:subH},children:(_subtitle$page=subtitle[page])===null||_subtitle$page===void 0?void 0:_subtitle$page.sort(function(a,b){return a.index-b.index;}).map(function(_ref2){var _editStyles$page;var text=_ref2.text,x=_ref2.x,y=_ref2.y,width=_ref2.width,size=_ref2.size,style=_ref2.style,index=_ref2.index;return/*#__PURE__*/_jsx(SubTitle,{id:index,text:text,globalStyle:subtitle.__global_style__,editStyles:editStyles===null||editStyles===void 0?void 0:(_editStyles$page=editStyles[page])===null||_editStyles$page===void 0?void 0:_editStyles$page[index],x:x,y:y,width:width,size:size*subW/100,style:style},index);})}),/*#__PURE__*/_jsx(\"img\",_objectSpread({onLoad:updateSubs,ref:imgRef,src:imgPath,alt:page},props))]});};var SubTitle=function SubTitle(_ref3){var text=_ref3.text,x=_ref3.x,y=_ref3.y,width=_ref3.width,size=_ref3.size,style=_ref3.style,id=_ref3.id,globalStyle=_ref3.globalStyle,editStyles=_ref3.editStyles;return/*#__PURE__*/_jsx(\"p\",{id:\"\".concat(id),style:_objectSpread(_objectSpread(_objectSpread({position:\"absolute\",top:\"\".concat(y,\"%\"),left:\"\".concat(x,\"%\"),width:\"\".concat(width,\"%\"),fontSize:\"\".concat(size,\"px\")},style),globalStyle),editStyles),children:text});};export default ImageSubTittle;","map":{"version":3,"sources":["/home/intelie/Documents/srt2/src/cmponents/ImageSubTittle.tsx"],"names":["React","useEffect","useRef","useState","ImageSubTittle","imgPath","subtitle","page","editStyles","props","imgRef","subY","setSubY","subX","setSubX","subH","setSubH","subW","setSubW","updateSubs","current","offsetTop","offsetLeft","offsetHeight","offsetWidth","window","addEventListener","removeEventListener","position","zIndex","top","left","width","height","sort","a","b","index","map","text","x","y","size","style","__global_style__","SubTitle","id","globalStyle","fontSize"],"mappings":"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","sourcesContent":["import React, { useEffect, useMemo, useRef, useState } from \"react\";\nimport { parsePSRTFileToObject } from \"../service/subtitle\";\n\n// import { Container } from './styles';\n\nexport type ImageStyle = {\n  [page: string]: {\n    [id: number]: React.CSSProperties;\n  };\n};\n\nconst ImageSubTittle: React.FC<{\n  imgPath: string;\n  subtitle: {\n    __global_style__?: React.CSSProperties;\n    [page: string]: {\n      x: number;\n      y: number;\n      width: number;\n      size: number;\n      text: string;\n      index: number;\n      style: React.CSSProperties;\n    }[];\n  };\n  page: string;\n  editStyles?:ImageStyle;\n  style?: React.CSSProperties;\n  [prop: string]: any;\n}> = ({ imgPath, subtitle, page, editStyles, ...props }) => {\n  const imgRef = useRef<HTMLImageElement>(null);\n  const [subY, setSubY] = useState<any>(0);\n  const [subX, setSubX] = useState<any>(0);\n  const [subH, setSubH] = useState<any>(0);\n  const [subW, setSubW] = useState<any>(0);\n  const updateSubs = () => {\n    setSubY(imgRef.current?.offsetTop);\n    setSubX(imgRef.current?.offsetLeft);\n    setSubH(imgRef.current?.offsetHeight);\n    setSubW(imgRef.current?.offsetWidth);\n  };\n\n  useEffect(() => {\n    window.addEventListener(\"resize\", updateSubs);\n    return () => {\n      window.removeEventListener(\"resize\", updateSubs);\n    };\n  }, []);\n\n  return (\n    <div>\n      <div\n        style={{\n          position: \"absolute\",\n          zIndex: 11,\n          top: subY,\n          left: subX,\n          width: subW,\n          height: subH,\n        }}\n      >\n        {subtitle[page]\n          ?.sort((a, b) => a.index - b.index)\n          .map(({ text, x, y, width, size, style, index }) => (\n            <SubTitle\n              key={index}\n              id={index}\n              text={text}\n              globalStyle={subtitle.__global_style__}\n              editStyles={editStyles?.[page]?.[index]}\n              x={x}\n              y={y}\n              width={width}\n              size={(size * subW) / 100}\n              style={style}\n            />\n          ))}\n      </div>\n      <img\n        onLoad={updateSubs}\n        ref={imgRef}\n        src={imgPath}\n        alt={page}\n        {...props}\n      />\n    </div>\n  );\n};\n\nconst SubTitle = ({\n  text,\n  x,\n  y,\n  width,\n  size,\n  style,\n  id,\n  globalStyle,\n  editStyles,\n}: {\n  text: string;\n  x: number;\n  y: number;\n  width?: number;\n  globalStyle?: React.CSSProperties;\n  editStyles?:React.CSSProperties\n  [k: string]: any;\n}) => {\n  \n  return (\n    <p\n      id={`${id}`}\n      style={{\n        position: \"absolute\",\n        top: `${y}%`,\n        left: `${x}%`,\n        width: `${width}%`,\n        fontSize: `${size}px`,\n        ...style,\n        ...globalStyle,\n        ...editStyles\n      }}\n    >\n      {text}\n    </p>\n  );\n};\n\nexport default ImageSubTittle;\n"]},"metadata":{},"sourceType":"module"}